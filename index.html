<html>

<head>
    <title>Our story begin..</title>
    <style>
        canvas {
            display: block;
            background-color: #f0bfc6;
        }
    </style>
</head>

<body>
    <canvas id="mainCanvas" width="700" height="1000"></canvas>
    <script>
        var canvas = document.getElementById("mainCanvas");
        var ctx = canvas.getContext("2d");
        var h = screen.height - 40;
        var w = screen.width - 20;
        var head_x = 0,
            head_animation_counter;
        const headSize = 40
        const bodySize = 140
        const armLength = 45

        let screenW = document.documentElement.clientWidth; //屏幕宽度
        let screenH = document.documentElement.clientHeight; //屏幕高度
        h = screenH;
        w = screenW;
        var rx = w / 2,
            ry = h / 2 - 100;
        let gameW = 1529,
            gameH = 832; //标准分辨率,也就是开发时的分辨率
        var sx;
        let kW = screenW / gameW; //屏幕宽度与标准宽度的比值
        let kH = 1; //屏幕高度与标准高度的比值

        //根据宽度比例适配
        let dY = (screenH - gameH * kW) / 2; //黑色区域的高度
        //当dY小于0时，画面纵向压缩。不然部分内容就会到屏幕外面去了
        if (dY < 0) {
            dY = 0;
            kH = screenH / gameH;
        }

        let scaleH = kW; //高度缩放率，默认以宽度比例
        //设置canvas的绝对大小与屏幕一致
        canvas.width = screenW;
        canvas.height = screenH;
        h -= 200;
        async function draw() {
            sx = w / 2 - 350;
            f1(ctx, sx, h / 2, 'black', 10)

            await sleep(150)
            for (let d = 45; d > 0; d -= 5) {

                f2(ctx, sx, h / 2, 'black', 10, d)

                await sleep(50)
            }
            f4(ctx, sx, h / 2, 'black', 10)

            await sleep(300)


            var distance = 300
            for (let delta = 0; delta <= distance; delta += distance / 10) {

                f5(ctx, sx + delta, h / 2, 'black', 10)

                await sleep(100)
                f6(ctx, sx + delta, h / 2, 'black', 10)

                await sleep(100)
                f7(ctx, sx + delta, h / 2, 'black', 10)
                await sleep(100)
            }
            f6(ctx, sx + distance, h / 2, 'black', 10)
            await sleep(200)
            var len_ = 55;
            for (let delta = 0; delta <= len_; delta += 5) {
                f8(ctx, sx + distance, h / 2, 'black', 10, delta);
                await sleep(50);
            }
            var len__ = 55;
            for (let delta = 0; delta <= len__; delta += 5) {
                right1(ctx, sx + distance, h / 2, 'black', 10, delta);
                await sleep(50);
            }
            var r_max = 180;
            for (let delta = 10; delta <= r_max; delta += 10) {
                ctx.clearRect(0, 0, w, h);
                ctx.beginPath();
                ctx.save();
                ctx.strokeStyle = "red";
                ctx.lineWidth = 10;
                ctx.fillStyle = "#f0bfc6";
                ctx.shadowColor = "red";
                ctx.shadowBlur = delta + 10;
                ctx.lineJoin = "round";
                ctx.lineCap = "round";
                ctx.translate(sx + distance + 65 - delta * 1.3, h / 2 + 55);
                ctx.rotate(-45 * Math.PI / 180);
                ctx.arc(delta, 0, delta, 0, 2 * Math.PI);
                ctx.arc(2 * delta, delta, delta, 0, 2 * Math.PI);
                ctx.rect(0, 0, 2 * delta, 2 * delta);
                ctx.stroke();
                ctx.fill();
                ctx.restore();
                final_left(ctx, sx + 300, h / 2, 'black', 10, 55);
                final_right(ctx, sx + 300, h / 2, 'black', 10, 55);
                await sleep(20);
            }
            await sleep(700);
            ctx.clearRect(0, 0, w, h);
            final_heart(ctx);
            final_left(ctx, sx + 300, h / 2, 'black', 10, 55);
            final_right(ctx, sx + 300, h / 2, 'black', 10, 55);
            drawText(ctx, sx + 357, h / 2 - 100, "...", 'black', true);


            await sleep(2000);
            ctx.clearRect(0, 0, w, h);
            final_heart(ctx);
            final_left(ctx, sx + 300, h / 2, 'black', 10, 55);
            final_right(ctx, sx + 300, h / 2, 'black', 10, 55);
            drawText(ctx, sx + 400, h / 2 - 100, "这个心好丑啊", 'black', false);

            await sleep(2500);
            ctx.clearRect(0, 0, w, h);
            final_heart(ctx);
            final_left(ctx, sx + 300, h / 2, 'black', 10, 55);
            final_right(ctx, sx + 300, h / 2, 'black', 10, 55);
            drawText(ctx, sx + 200, h / 2 - 100, "要饭还嫌粥凉", 'black', false);
            await sleep(2000);
            let final_beat_len = 10;
            for (let index = 0; index <= final_beat_len; index += 0.5) {
                await sleep(50);
                ctx.clearRect(0, 0, w, h);
                final_heart(ctx);
                final_left(ctx, sx + 300, h / 2, 'black', 10, 55);
                final_right_beat(ctx, sx + 300, h / 2, 'black', 10, 55);
                beat_before(ctx, sx + 300, h / 2, 'black', 10, 55, Math.PI / 4.5 * (1 - index / (final_beat_len + 1)), index)

            }
            await sleep(200);
            for (let index = final_beat_len; index >= 5.5; index -= 0.5) {
                await sleep(6);
                ctx.clearRect(0, 0, w, h);
                final_heart(ctx);
                final_left(ctx, sx + 300, h / 2, 'black', 10, 55);
                final_right_beat(ctx, sx + 300, h / 2, 'black', 10, 55);
                beat_before(ctx, sx + 300, h / 2, 'black', 10, 55, Math.PI / 4.5 * (1 - index / (final_beat_len + 1)), final_beat_len)

            }
            let drop_d = 2000;
            for (let index = 0; index <= drop_d; index += 20) {
                await sleep(3);
                ctx.clearRect(0, 0, w, 2500);
                final_heart(ctx);
                final_stay_heart(ctx, sx + 300, h / 2, 'black', 10, 55);
                final_right_beat(ctx, sx + 300, h / 2, 'black', 10, 55);
                beat_before(ctx, sx + 300, h / 2, 'black', 10, 55, Math.PI / 4.5 * (1 - 5.5 / (final_beat_len + 1)), final_beat_len);
                drop_left(ctx, sx + 300, h / 2 + index, 'black', 55);

            }
        }


        /**
         * 跳舞绘制 
         * 绘制头部 drawHead 
         * 绘制躯干 drawBody 
         * 绘制手臂 drawArms 
         * 绘制爱心 drawHeart 
         * **/

        function f1(ctx, x, y, color, r) {
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize / 2 - Math.sin(Math.PI / 3) * armLength, y + Math.cos(Math.PI / 6) * bodySize / 2 - Math.cos(Math.PI / 3) * armLength);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize / 2 + Math.sin(Math.PI / 3) * armLength, y + Math.cos(Math.PI / 6) * bodySize / 2 - Math.cos(Math.PI / 3) * armLength);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            ctx.beginPath();
            ctx.save();
            ctx.fillStyle = "red";
            ctx.shadowColor = "red";
            ctx.shadowBlur = 20;
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.translate(x + Math.sin(Math.PI / 6) * bodySize / 2 + Math.sin(Math.PI / 3) * armLength, y + Math.cos(Math.PI / 6) * bodySize / 2 - Math.cos(Math.PI / 3) * armLength);
            ctx.rotate(-45 * Math.PI / 180);
            ctx.arc(r, 0, r, 0, 2 * Math.PI);
            ctx.arc(2 * r, r, r, 0, 2 * Math.PI);
            ctx.rect(0, 0, 2 * r, 2 * r);
            ctx.fill();
            ctx.restore();
            right(ctx, rx, ry, color, r);
        }

        function f2(ctx, x, y, color, r, l) {
            ctx.clearRect(0, 0, w, h)
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + l, y + Math.cos(Math.PI / 6) * bodySize / 2 - Math.cos(Math.PI / 6) * l);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + l, y + Math.cos(Math.PI / 6) * bodySize / 2 - Math.cos(Math.PI / 6) * l);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            ctx.beginPath();
            ctx.save();
            ctx.fillStyle = "red";
            ctx.shadowColor = "red";
            ctx.shadowBlur = 20;
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.translate(x + l, y + Math.cos(Math.PI / 6) * bodySize / 2 - Math.cos(Math.PI / 6) * l);
            ctx.rotate(-45 * Math.PI / 180);
            ctx.arc(r, 0, r, 0, 2 * Math.PI);
            ctx.arc(2 * r, r, r, 0, 2 * Math.PI);
            ctx.rect(0, 0, 2 * r, 2 * r);
            ctx.fill();
            ctx.restore();
            right(ctx, rx, ry, color, r);
        }

        function f3(ctx, x, y, color, r) {
            ctx.clearRect(0, 0, w, h)
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize / 2 - Math.sin(Math.PI / 6) * armLength / 2, y + Math.cos(Math.PI / 6) * bodySize / 2 - Math.cos(Math.PI / 6) * armLength / 2);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize / 2 + Math.sin(Math.PI / 6) * armLength / 2, y + Math.cos(Math.PI / 6) * bodySize / 2 - Math.cos(Math.PI / 6) * armLength / 2);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            ctx.beginPath();
            ctx.save();
            ctx.fillStyle = "red";
            ctx.shadowColor = "red";
            ctx.shadowBlur = 20;
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.translate(x + Math.sin(Math.PI / 6) * bodySize / 2 + Math.sin(Math.PI / 6) * armLength / 2, y + Math.cos(Math.PI / 6) * bodySize / 2 - Math.cos(Math.PI / 6) * armLength / 2);
            ctx.rotate(-45 * Math.PI / 180);
            ctx.arc(r, 0, r, 0, 2 * Math.PI);
            ctx.arc(2 * r, r, r, 0, 2 * Math.PI);
            ctx.rect(0, 0, 2 * r, 2 * r);
            ctx.fill();
            ctx.restore();
            right(ctx, rx, ry, color, r);
        }

        function f4(ctx, x, y, color, r) {
            ctx.clearRect(0, 0, w, h)
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x, y + 45);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x, y + 45);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            ctx.beginPath();
            ctx.save();
            ctx.fillStyle = "red";
            ctx.shadowColor = "red";
            ctx.shadowBlur = 20;
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.translate(x, y + 45);
            ctx.rotate(-45 * Math.PI / 180);
            ctx.arc(r, 0, r, 0, 2 * Math.PI);
            ctx.arc(2 * r, r, r, 0, 2 * Math.PI);
            ctx.rect(0, 0, 2 * r, 2 * r);
            ctx.fill();
            ctx.restore();
            right(ctx, rx, ry, color, r);
        }



        var deltaY = 20

        function f5(ctx, x, y, color, r) {

            ctx.clearRect(0, 0, w, h);
            ctx.save();
            ctx.translate(x, y + deltaY);
            ctx.rotate(7 * Math.PI / 180);
            x = 0;
            y = -deltaY;
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x, y + 45);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x, y + 45);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            ctx.beginPath();
            ctx.save();
            ctx.fillStyle = "red";
            ctx.shadowColor = "red";
            ctx.shadowBlur = 20;
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.translate(x, y + 45);
            ctx.rotate(-45 * Math.PI / 180);
            ctx.arc(r, 0, r, 0, 2 * Math.PI);
            ctx.arc(2 * r, r, r, 0, 2 * Math.PI);
            ctx.rect(0, 0, 2 * r, 2 * r);
            ctx.fill();
            ctx.restore();

            ctx.restore();
            right(ctx, rx, ry, color, r);
        }

        function f6(ctx, x, y, color, r) {
            ctx.clearRect(0, 0, w, h)
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x, y + 45);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x, y + 45);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            ctx.beginPath();
            ctx.save();
            ctx.fillStyle = "red";
            ctx.shadowColor = "red";
            ctx.shadowBlur = 20;
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.translate(x, y + 45);
            ctx.rotate(-45 * Math.PI / 180);
            ctx.arc(r, 0, r, 0, 2 * Math.PI);
            ctx.arc(2 * r, r, r, 0, 2 * Math.PI);
            ctx.rect(0, 0, 2 * r, 2 * r);
            ctx.fill();
            ctx.restore();
            right(ctx, rx, ry, color, r);
        }

        function f7(ctx, x, y, color, r) {

            ctx.clearRect(0, 0, w, h);
            ctx.save();
            ctx.translate(x, y + deltaY);
            ctx.rotate(-7 * Math.PI / 180);
            x = 0;
            y = -deltaY;
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x, y + 45);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x, y + 45);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            ctx.beginPath();
            ctx.save();
            ctx.fillStyle = "red";
            ctx.shadowColor = "red";
            ctx.shadowBlur = 20;
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.translate(x, y + 45);
            ctx.rotate(-45 * Math.PI / 180);
            ctx.arc(r, 0, r, 0, 2 * Math.PI);
            ctx.arc(2 * r, r, r, 0, 2 * Math.PI);
            ctx.rect(0, 0, 2 * r, 2 * r);
            ctx.fill();
            ctx.restore();

            ctx.restore();
            right(ctx, rx, ry, color, r);
        }




        function f8(ctx, x, y, color, r, l) {
            ctx.clearRect(0, 0, w, h)
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + l, y + 45);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + l, y + 45);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            ctx.beginPath();
            ctx.save();
            ctx.fillStyle = "red";
            ctx.shadowColor = "red";
            ctx.shadowBlur = 20;
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.translate(x + l, y + 45);
            ctx.rotate(-45 * Math.PI / 180);
            ctx.arc(r, 0, r, 0, 2 * Math.PI);
            ctx.arc(2 * r, r, r, 0, 2 * Math.PI);
            ctx.rect(0, 0, 2 * r, 2 * r);
            ctx.fill();
            ctx.restore();
            right(ctx, rx, ry, color, r);
        }



        function sleep(time) {
            return new Promise((resolve) => setTimeout(resolve, time));
        }

        function final_left(ctx, x, y, color, r, l) {
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + l, y + 45);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + l, y + 45);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            ctx.beginPath();
            ctx.save();
            ctx.fillStyle = "red";
            ctx.shadowColor = "red";
            ctx.shadowBlur = 20;
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.translate(x + l, y + 45);
            ctx.rotate(-45 * Math.PI / 180);
            ctx.arc(r, 0, r, 0, 2 * Math.PI);
            ctx.arc(2 * r, r, r, 0, 2 * Math.PI);
            ctx.rect(0, 0, 2 * r, 2 * r);
            ctx.fill();
            ctx.restore();




        }

        function right(ctx, x, y, color, r) {
            x += 100
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize / 2 - Math.sin(Math.PI / 4.5) * armLength, y + Math.cos(Math.PI / 6) * bodySize / 2 - Math.cos(Math.PI / 4.5) * armLength);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize / 2 + Math.sin(Math.PI / 4.5) * armLength, y + Math.cos(Math.PI / 6) * bodySize / 2 - Math.cos(Math.PI / 4.5) * armLength);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

        }

        function right1(ctx, x, y, color, r, l) {
            ctx.clearRect(0, 0, w, h);
            final_left(ctx, sx + 300, h / 2, 'black', 10, 55);
            x += 150
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize / 2 - Math.sin(Math.PI / 4.5) * armLength - l * 0.25, y + 45);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize / 2 + Math.sin(Math.PI / 4.5) * armLength - l * 2.5, y + 45);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

        }

        function final_right(ctx, x, y, color, r, l) {
            x += 150
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize / 2 - Math.sin(Math.PI / 4.5) * armLength - l * 0.25, y + 45);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize / 2 + Math.sin(Math.PI / 4.5) * armLength - l * 2.5, y + 45);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

        }

        function drawText(ctx, x, y, str, color, f) {
            if (f)
                ctx.font = '40px "黑体"';
            else
                ctx.font = '20px "黑体"';
            ctx.fillStyle = color;
            ctx.textBaseline = "top";
            ctx.fillText(str, x, y);
        }

        function final_heart(ctx) {
            let delta = 180;
            ctx.beginPath();
            ctx.save();
            ctx.strokeStyle = "red";
            ctx.lineWidth = 10;
            ctx.fillStyle = "#f0bfc6";
            ctx.shadowColor = "red";
            ctx.shadowBlur = delta + 10;
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.translate(sx + 300 + 65 - delta * 1.3, h / 2 + 55);
            ctx.rotate(-45 * Math.PI / 180);
            ctx.arc(delta, 0, delta, 0, 2 * Math.PI);
            ctx.arc(2 * delta, delta, delta, 0, 2 * Math.PI);
            ctx.rect(0, 0, 2 * delta, 2 * delta);
            ctx.stroke();
            ctx.fill();
            ctx.restore();

        }

        function beat_before(ctx, x, y, color, r, l, ar, le) {
            x += 150
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);

            //ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize / 2 - Math.sin(Math.PI / 4.5) * armLength - l * 0.25, y + 45);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize / 2 - Math.sin(ar) * (armLength + le * 15) - l * 0.25, y + 45 - Math.cos(Math.PI / 2 - Math.PI / 4.5 + ar) * (armLength + le * 15));
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize / 2 + Math.sin(Math.PI / 4.5) * armLength - l * 2.5, y + 45);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();


        }

        function final_right_beat(ctx, x, y, color, r, l) {
            x += 150
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";

            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize / 2 + Math.sin(Math.PI / 4.5) * armLength - l * 2.5, y + 45);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

        }

        function final_stay_heart(ctx, x, y, color, r, l) {
            ctx.beginPath();
            ctx.save();
            ctx.fillStyle = "red";
            ctx.shadowColor = "red";
            ctx.shadowBlur = 20;
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.translate(x + l, y + 45);
            ctx.rotate(-45 * Math.PI / 180);
            ctx.arc(r, 0, r, 0, 2 * Math.PI);
            ctx.arc(2 * r, r, r, 0, 2 * Math.PI);
            ctx.rect(0, 0, 2 * r, 2 * r);
            ctx.fill();
            ctx.restore();

        }

        function drop_left(ctx, x, y, color, l) {
            ctx.beginPath();
            ctx.arc(x, y, headSize, 0, 2 * Math.PI);
            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.lineJoin = "round";
            ctx.lineCap = "round"
            ctx.stroke();

            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            ctx.moveTo(x - Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x + Math.sin(Math.PI / 6) * headSize, y + Math.cos(Math.PI / 6) * headSize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);
            ctx.lineTo(x + Math.sin(Math.PI / 6) * bodySize, y + Math.cos(Math.PI / 6) * bodySize);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();

            //手臂
            ctx.beginPath();
            ctx.lineJoin = "round";
            ctx.lineCap = "round";
            //left
            ctx.moveTo(x - Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + l, y + 45);
            //right

            ctx.moveTo(x + Math.sin(Math.PI / 6) * bodySize / 2, y + Math.cos(Math.PI / 6) * bodySize / 2);
            ctx.lineTo(x + l, y + 45);

            ctx.strokeStyle = color;
            ctx.lineWidth = 5;
            ctx.stroke();
        }

        draw();
    </script>
</body>

</html>